-- source include/have_innodb.inc

let $force_pk=`select @@innodb_force_primary_key`;

-- error 1173
CREATE TABLE T1(A INTEGER) ENGINE=INNODB;
SHOW WARNINGS;
-- error 1173
CREATE TABLE T1(A INTEGER UNIQUE KEY) ENGINE=INNODB;
SHOW WARNINGS;
-- error 1173
CREATE TABLE T1(A INTEGER NOT NULL, B INTEGER,
UNIQUE KEY(A,B)) ENGINE=INNODB;
SHOW WARNINGS;
CREATE TABLE T1(A INTEGER NOT NULL PRIMARY KEY) ENGINE=INNODB;
SHOW CREATE TABLE T1;
SHOW WARNINGS;
DROP TABLE T1;
CREATE TABLE T1(A INTEGER NOT NULL UNIQUE KEY) ENGINE=INNODB;
SHOW CREATE TABLE T1;
SHOW WARNINGS;
DROP TABLE T1;

set global innodb_force_primary_key = 0;
CREATE TABLE T1(A INTEGER) ENGINE=INNODB;
SHOW WARNINGS;
INSERT INTO T1 VALUES (1),(2),(3);

set global innodb_force_primary_key = 1;
SELECT * FROM T1;
-- error 1173
CREATE TABLE T2(A INTEGER) ENGINE=INNODB;
SHOW WARNINGS;
DROP TABLE T1;

--disable_query_log
eval set global innodb_force_primary_key=$force_pk;
--enable_query_log

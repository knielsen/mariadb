drop table if exists t1,t2;
create table t1 (a int, b int, v int as (a+1), index idx(b));
insert into t1(a, b) values
(4, 40), (3, 30), (5, 50), (7, 70), (8, 80), (2, 20), (1, 10);
select * from t1 order by b;
a	b	v
1	10	2
2	20	3
3	30	4
4	40	5
5	50	6
7	70	8
8	80	9
delete from t1 where v > 6 order by b limit 1;
select * from t1 order by b;
a	b	v
1	10	2
2	20	3
3	30	4
4	40	5
5	50	6
8	80	9
update t1 set a=v order by b limit 1;
select * from t1 order by b;
a	b	v
2	10	3
2	20	3
3	30	4
4	40	5
5	50	6
8	80	9
drop table t1;
CREATE TABLE t1 (
a int NOT NULL DEFAULT '0',
v double AS ((1, a)) VIRTUAL
);
ERROR HY000: Expression for computed column cannot return a row
CREATE TABLE t1 (
a CHAR(255) BINARY NOT NULL DEFAULT 0,
b CHAR(255) BINARY NOT NULL DEFAULT 0,
v CHAR(255) BINARY AS (CONCAT(a,b)) VIRTUAL );
INSERT INTO t1(a,b) VALUES ('4','7'), ('4','6');
SELECT 1 AS C FROM t1 ORDER BY v;
C
1
1
DROP TABLE t1;
CREATE TABLE t1 (
a datetime NOT NULL DEFAULT '2000-01-01',
v boolean AS (a < '2001-01-01')
);
INSERT INTO t1(a) VALUES ('2002-02-15');
INSERT INTO t1(a) VALUES ('2000-10-15');
SELECT a, v FROM t1;
a	v
2002-02-15 00:00:00	0
2000-10-15 00:00:00	1
SELECT a, v FROM t1;
a	v
2002-02-15 00:00:00	0
2000-10-15 00:00:00	1
CREATE TABLE t2 (
a datetime NOT NULL DEFAULT '2000-01-01',
v boolean AS (a < '2001-01-01') PERSISTENT
);
INSERT INTO t2(a) VALUES ('2002-02-15');
INSERT INTO t2(a) VALUES ('2000-10-15');
SELECT * FROM t2;
a	v
2002-02-15 00:00:00	0
2000-10-15 00:00:00	1
DROP TABLE t1, t2;

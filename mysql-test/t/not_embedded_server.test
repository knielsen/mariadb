#
# Here we collect tests that doesn't work with the embedded server
#

-- source include/not_embedded.inc

# The following fails sporadically because 'check-testcase' runs
# queries before this test and there is no way to guarantee that any
# previous process finishes.  The purpose of the test is not clearly
# stated, there is no reference to any bug report, and "select from
# I_S from prepared statement" doesn't look like something that's
# really imporant to test.  I'm commenting out this for now.  If
# anyone wants to keep this, please fix the race and motivate why we
# need to test this.  If you see this comment and it is after mid-2009
# or so, feel free to remove this test from the file.  /Sven
#
#
## Show full process list with prepare
## To not show other connections, this must be the first test and we must
## have a server restart before this one
##
## We don't have any 4.1 tests as we use I_S to query the PROCESSLIST to
## exclude system threads that may/may not be active in the server
## (namely the ndb injector thread)
##
## End of 4.1 tests
#
#prepare stmt1 from ' SELECT * FROM INFORMATION_SCHEMA.PROCESSLIST WHERE COMMAND!=\'Daemon\' ';
#--replace_column 1 number 6 time 3 localhost 9 time_ms
#execute stmt1;
#deallocate prepare stmt1;

call mtr.add_suppression("Can't open and lock privilege tables: Table 'host' was not locked with LOCK TABLES");

#
# Bug#43835: SHOW VARIABLES does not include 0 for slave_skip_errors
#

SHOW VARIABLES like 'slave_skip_errors';

# End of 5.1 tests

--echo #
--echo # WL#4284: Transactional DDL locking
--echo #
--echo # FLUSH PRIVILEGES should not implicitly unlock locked tables.
--echo #
--disable_warnings
drop table if exists t1;
--enable_warnings
create table t1 (c1 int);
lock tables t1 read;
--error ER_TABLE_NOT_LOCKED
flush privileges;
unlock tables;
drop table t1;
